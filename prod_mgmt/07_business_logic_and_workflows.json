{
  "step": "07_business_logic_and_workflows",
  "title": "Business Logic & Workflows",
  "purpose": "Understand the core business processes and how they're implemented",
  "estimated_time": "50 minutes",
  
  "tasks": [
    {
      "task": "Map key business workflows",
      "primary_workflows": {
        "patient_data_sync": {
          "trigger": "Manual or scheduled sync",
          "process": "Cliniko API → Transform → Database → Frontend",
          "files": ["src/services/cliniko_sync_service.py"],
          "business_value": "Keeps patient data current"
        },
        "patient_activity_analysis": {
          "trigger": "During sync process",
          "process": "Appointments → Activity scoring → Patient status",
          "logic": "Recent/upcoming appointment counts determine activity",
          "business_value": "Identifies at-risk patients"
        },
        "communication_tracking": {
          "trigger": "Chatwoot webhook or sync",
          "process": "Messages → Conversations → Patient linking",
          "business_value": "Centralized patient communication"
        },
        "user_access_control": {
          "trigger": "User login/API access",
          "process": "Clerk auth → Organization membership → Data filtering",
          "business_value": "Secure multi-tenant access"
        }
      }
    },
    {
      "task": "Understand data transformation logic",
      "transformation_areas": [
        "Patient record normalization from Cliniko",
        "Appointment data aggregation and scoring",
        "Phone number standardization",
        "Activity status calculation"
      ],
      "files_to_analyze": [
        "src/services/cliniko_sync_service.py - analyze_active_patients()",
        "Patient activity scoring algorithms",
        "Data validation and cleaning logic"
      ]
    },
    {
      "task": "Review error handling and resilience",
      "error_scenarios": [
        "External API failures",
        "Data validation errors", 
        "Network connectivity issues",
        "Authentication problems"
      ],
      "resilience_patterns": [
        "Retry mechanisms",
        "Graceful degradation",
        "Error logging and monitoring",
        "Partial sync recovery"
      ]
    },
    {
      "task": "Identify business rules and constraints",
      "business_rules": [
        "Patient activity classification criteria",
        "Organization data isolation requirements",
        "Sync frequency limitations",
        "Data retention policies"
      ]
    }
  ],
  
  "expected_outcomes": [
    "Clear understanding of core business processes",
    "Knowledge of data transformation logic",
    "Awareness of error handling strategies",
    "Understanding of business rules implementation"
  ],
  
  "deliverable": "Create prod_mgmt/workflow_diagram.md with process flows",
  "next_step": "08_deployment_and_infrastructure"
} 